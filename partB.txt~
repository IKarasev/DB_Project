#5
SELECT first_name||' '||last_name AS EMPLOYEE, hire_date AS HIRED, name AS 'TRAINING',
       date_acquired AS 'DATE', (date_acquired-date_hired) as 'PERIOD'
FROM employee LEFT JOIN training USING (emp_num)
WHERE EXTRACT(year FROM hire_date) = 13d
ORDER BY GROUPING SETS((first_name,last_name,hire_date),());

#6
SELECT proj_number AS "ID", name AS "PROJECT", start_date as "STARTED",
       NVL2(total_cost,'completed','on-going')
FROM project P1
WHERE TO_NUMBER(0) <> (
       SELECT COUNT(DISTINCT date_assigned)-MONTHS_BETWEEN(MAX(date_ended),MIN(date_assigned))
       FROM assignment
       WHERE proj_number = P1.proj_number
);

SELECT DISTINCT A1.assign_num, A2.assign_num
FROM assignment A1 JOIN assignment A2 ON (A1.proj_number = A2.proj_number)
WHERE (A1.date_ended < A2.date_assigned)
      AND (A1.date_assigned < A2.date_assigned);

SELECT proj_number FROM assignment
WHERE 


SELECT COUNT(DISTINCT date_assigned)-MONTHS_BETWEEN(MAX(date_ended),MIN(date_assigned)) FROM assignment
WHERE proj_number = 1009;



#7
SELECT * FROM (
SELECT TO_CHAR('1 Quarter') AS "QUARTER", count(DISTINCT proj_number) AS "PROJECTS",
       count(DISTINCT emp_num) AS "EMPLOYEES",
       ROUND((SUM(hours_used)/count(DISTINCT proj_number)),2) AS "TIME AVERAGE"
FROM project JOIN assignment USING (proj_number)
     JOIN employee USING (emp_num)
WHERE (start_date >= TO_DATE('01-01-2013','DD-MM-YYYY'))
      AND (start_date < TO_DATE('01-04-2013','DD-MM-YYYY'))
GROUP BY to_char('1 Quarter')
UNION
SELECT TO_CHAR('2 Quarter'), count(DISTINCT proj_number),
       count(DISTINCT emp_num),
       ROUND((SUM(hours_used)/count(DISTINCT proj_number)),2)
FROM project JOIN assignment USING (proj_number)
     JOIN employee USING (emp_num)
WHERE (start_date >= TO_DATE('01-04-2013','DD-MM-YYYY'))
      AND (start_date < TO_DATE('01-07-2013','DD-MM-YYYY'))
GROUP BY to_char('2  Quarter')
UNION
SELECT TO_CHAR('3 Quarter'), count(DISTINCT proj_number),
       count(DISTINCT emp_num),
       ROUND((SUM(hours_used)/count(DISTINCT proj_number)),2)
FROM project JOIN assignment USING (proj_number)
     JOIN employee USING (emp_num)
WHERE (start_date >= TO_DATE('01-07-2013','DD-MM-YYYY'))
      AND (start_date < TO_DATE('01-10-2013','DD-MM-YYYY'))
GROUP BY to_char('3  Quarter') 
UNION
SELECT TO_CHAR('4 Quarter'), count(DISTINCT proj_number),
       count(DISTINCT emp_num),
       ROUND((SUM(hours_used)/count(DISTINCT proj_number)),2)
FROM project JOIN assignment USING (proj_number)
     JOIN employee USING (emp_num)
WHERE (start_date >= TO_DATE('01-10-2013','DD-MM-YYYY'))
      AND (start_date < TO_DATE('01-01-2014','DD-MM-YYYY'))
GROUP BY to_char('4 Quarter')
)
ORDER BY 1;
#8

#9
SELECT department.name AS "DEPARTMENT", description AS "SKILL", count(DISTINCT train_num) AS "TRAININGS",
       RANK() OVER (ORDER BY count(DISTINCT train_num) DESC NULLS LAST) AS "RANK"
FROM department LEFT JOIN employee USING(dept_code)
     LEFT JOIN training USING(emp_num)
     JOIN skill USING(code)
WHERE date_acquired < SYSDATE
GROUP BY (department.name,description);





